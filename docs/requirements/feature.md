# Требования к Chrome плагину для автоматизации работы с админ-панелями

## Описание проекта

Chrome расширение для автоматизации копирования данных из веб-форм в админ-панелях с помощью настраиваемых шаблонов.

## Цель

Устранить необходимость ручного копирования значений из множественных полей веб-форм, предоставив возможность создания шаблонов для автоматического извлечения и форматирования данных в буфер обмена.

## Функциональные требования

### 1. Создание и управление шаблонами

#### 1.1 Создание шаблона
- **FR-001**: Пользователь должен иметь возможность создать новый шаблон через интерфейс расширения
- **FR-002**: При создании шаблона пользователь должен указать:
  - Название шаблона
  - Список полей для извлечения данных

#### 1.2 Интерактивный выбор полей на странице
- **FR-003**: Пользователь должен иметь возможность активировать режим выбора элементов:
  - Кнопка "Добавить поле" в интерфейсе создания/редактирования шаблона
  - Переход в режим интерактивного выбора элементов на странице
  - Визуальное выделение элементов при наведении курсора

- **FR-004**: При наведении на элемент в режиме выбора должно отображаться:
  - Подсветка элемента (outline или цветная рамка)
  - Всплывающая подсказка с информацией об элементе:
    - Тип элемента (input, select, textarea, div, span и т.д.)
    - Текущее значение или содержимое
    - Автоматически сгенерированный CSS селектор
    - Предложенное имя поля

- **FR-005**: По клику на элемент должно происходить:
  - Добавление поля в текущий шаблон
  - Автоматическое определение оптимального CSS селектора
  - Предложение осмысленного имени поля на основе label, placeholder или содержимого

- **FR-006**: Автоматическое определение CSS селектора должно использовать приоритет:
  1. ID элемента (если уникальный)
  2. Name атрибут (если уникальный)
  3. Комбинация тегов и классов
  4. XPath в крайнем случае
  5. Возможность ручного редактирования селектора

#### 1.4 Управление шаблонами
- **FR-009**: Пользователь должен иметь возможность:
  - Просматривать список всех созданных шаблонов
  - Редактировать существующие шаблоны
  - Дублировать шаблоны
  - Удалять шаблоны
  - Импортировать/экспортировать шаблоны (JSON формат)

### 2. Применение шаблонов

#### 2.1 Автоматическое определение шаблона
- **FR-007**: Расширение должно автоматически определять подходящий шаблон для текущей страницы на основе URL
- **FR-008**: При наличии нескольких подходящих шаблонов пользователь должен иметь возможность выбрать нужный

#### 2.2 Извлечение и форматирование данных
- **FR-009**: По клику на иконку расширения или горячую клавишу должно происходить:
  - Извлечение данных согласно активному шаблону
  - Формирование строки с значениями полей, разделенными переносами строк
  - Копирование результата в буфер обмена
  - Показ уведомления об успешном копировании

- **FR-010**: Формат данных в буфере обмена:
  - Каждое значение поля на отдельной строке
  - Порядок строк соответствует порядку полей в шаблоне
  - Пустые поля пропускаются (не добавляют пустую строку)
  - Значения обрезаются от лишних пробелов автоматически
  - Пример для полей [Имя, Email, Телефон, Статус]:
    ```
    Иван Петров
    ivan.petrov@example.com
    +7 999 123-45-67
    Активен
    ```

#### 2.3 Контекстное меню
- **FR-011**: При нажатии правой кнопки мыши на странице должно появляться контекстное меню с разделом расширения:
  - Список всех созданных пользователем шаблонов
  - Возможность выбрать и применить любой шаблон независимо от URL
  - Визуальное разделение от стандартных пунктов браузера
  - Иконка расширения рядом с названием каждого шаблона

- **FR-012**: В контекстном меню должны отображаться:
  - Только шаблоны пользователя (не более 10 для удобства)
  - Название каждого шаблона
  - Индикатор подходящих шаблонов (например, выделение цветом для URL-совместимых)
  - Опция "Управление шаблонами" для быстрого перехода к настройкам

### 3. Интерфейс пользователя

#### 3.1 Popup интерфейс
- **FR-015**: Компактный popup с основными функциями:
  - Список доступных для текущей страницы шаблонов
  - Кнопка применения выбранного шаблона
  - Быстрый доступ к настройкам
  - Индикатор статуса последней операции

#### 3.2 Страница настроек
- **FR-016**: Отдельная страница настроек должна содержать:
  - Управление шаблонами (CRUD операции)
  - Общие настройки расширения
  - Импорт/экспорт конфигурации
  - Справочную информацию

#### 3.3 Режим интерактивного выбора элементов
- **FR-017**: При активации режима выбора элементов:
  - Должно появляться полупрозрачное оверлей на странице
  - Элементы должны подсвечиваться при наведении курсора
  - Должна быть видна панель инструментов с кнопками:
    - "Завершить выбор"
    - "Отменить"
    - "Справка по выбору элементов"
  - Курсор должен измениться на pointer/crosshair для индикации режима

- **FR-018**: Визуальная подсветка элементов должна включать:
  - Цветную рамку вокруг элемента (настраиваемый цвет)
  - Всплывающую подсказку с информацией об элементе
  - Затемнение остальной части страницы для фокуса
  - Анимированные переходы для плавности интерфейса

- **FR-019**: Панель предварительного просмотра должна показывать:
  - Список уже выбранных полей
  - Предварительный просмотр извлеченных данных
  - Возможность быстрого удаления полей
  - Кнопку для тестирования текущего шаблона

#### 3.4 Визуальные индикаторы
- **FR-020**: На веб-странице должны отображаться:
  - Подсветка полей, которые будут извлечены активным шаблоном
  - Возможность клика по элементу для добавления в шаблон (режим настройки)

## Нефункциональные требования

### 1. Производительность
- **NFR-001**: Извлечение данных должно происходить не более чем за 2 секунды
- **NFR-002**: Расширение не должно замедлять загрузку веб-страниц
- **NFR-003**: Поддержка работы с динамическим контентом (AJAX)

### 2. Совместимость
- **NFR-004**: Поддержка Chrome версии 88 и выше
- **NFR-005**: Работа с различными типами веб-приложений (SPA, традиционные сайты)
- **NFR-006**: Совместимость с основными CSS фреймворками

### 3. Безопасность
- **NFR-007**: Все данные шаблонов хранятся локально в chrome.storage.local:
  - Шаблоны сохраняются в локальном хранилище браузера
  - Используется Chrome Extensions Storage API (chrome.storage.local)
  - Данные доступны только для расширения и не передаются в интернет
  - Максимальный размер хранилища: 5MB (лимит chrome.storage.local)
  - Данные сохраняются между сессиями браузера
  - При удалении расширения все данные удаляются автоматически
  - Поддержка резервного копирования через экспорт в JSON файл
  - Импорт настроек из JSON файла для восстановления или переноса между устройствами
- **NFR-008**: Отсутствие передачи пользовательских данных на внешние серверы
- **NFR-009**: Минимальные необходимые разрешения для Chrome API

### 4. Надежность
- **NFR-010**: Обработка ошибок при недоступности элементов на странице
- **NFR-011**: Восстановление после обновления страницы
- **NFR-012**: Резервное копирование настроек в Chrome sync storage

### 5. Удобство использования
- **NFR-013**: Интуитивно понятный интерфейс
- **NFR-014**: Контекстная справка и подсказки
- **NFR-015**: Поддержка отмены операций

## Пользовательские сценарии

### Сценарий 1: Создание шаблона с интерактивным выбором полей
1. Пользователь открывает админ-панель с формой
2. Кликает на иконку расширения → "Создать новый шаблон"
3. Вводит название шаблона (например, "Карточка пользователя")
4. Нажимает кнопку "Добавить поле"
5. Страница переходит в режим выбора элементов:
   - Появляется полупрозрачное оверлей
   - Панель инструментов в верхней части
   - Боковая панель с уже выбранными полями
6. Пользователь наводит курсор на поле "Имя пользователя":
   - Поле подсвечивается цветной рамкой
   - Появляется всплывающая подсказка: "input[name='username'] | Текущее значение: 'john_doe'"
7. Кликает на поле - оно добавляется в шаблон:
   - В боковой панели появляется элемент "username (textContent)"
   - Поле получает постоянную подсветку как "выбранное"
8. Аналогично выбирает поля email, phone, status
9. Нажимает "Завершить выбор"
10. В редакторе шаблона видит все выбранные поля с возможностью:
    - Переименовать псевдонимы полей
    - Изменить порядок полей
11. Сохраняет шаблон

### Сценарий 2: Применение шаблона через контекстное меню
1. Пользователь открывает админ-панель с формой пользователя
2. Нажимает правую кнопку мыши в любом месте страницы
3. В контекстном меню видит раздел расширения со списком шаблонов:
   - "Карточка пользователя" (подсвечен как подходящий)
   - "Информация о заказе"
   - "Контактные данные"
   - "Управление шаблонами"
4. Кликает на "Карточка пользователя"
5. Данные автоматически извлекаются и копируются в буфер
6. Появляется уведомление: "Данные скопированы (4 поля)"
7. Пользователь может сразу вставить данные в нужное место

### Сценарий 3: Применение существующего шаблона через popup
1. Пользователь открывает знакомую админ-панель
2. Расширение автоматически определяет подходящий шаблон
3. Пользователь нажимает горячую клавишу или кликает иконку
4. Данные извлекаются и копируются в буфер
5. Появляется уведомление об успешном копировании

## Технические ограничения

### 1. Chrome Extensions API
- Использование Manifest V3
- Ограничения на content scripts
- Политики безопасности CSP

### 2. DOM доступ
- Работа с Shadow DOM
- Обработка динамически загружаемого контента
- Совместимость с различными JavaScript фреймворками

### 3. Хранение данных
- Лимиты Chrome storage API
- Синхронизация между устройствами
- Производительность при большом количестве шаблонов

## Критерии приемки

1. **Основная функциональность**: Пользователь может создать шаблон, извлечь данные из 5+ полей и скопировать в буфер одним действием
2. **Интерактивный выбор**: Пользователь может создать шаблон за 2 минуты, выбирая поля кликами на странице без знания CSS селекторов
3. **Контекстное меню**: Любой шаблон можно применить через правый клик мыши
4. **Точность селекторов**: Автоматически сгенерированные CSS селекторы работают корректно в 90% случаев
5. **Производительность**: Извлечение данных происходит мгновенно на страницах с до 100 полей форм
6. **Надежность**: Расширение корректно работает на 95% популярных админ-панелей
7. **Совместимость**: Поддержка основных браузеров семейства Chromium

## Риски и ограничения

### Технические риски
- Изменения в структуре целевых веб-приложений могут сломать шаблоны
- Ограничения Chrome Extensions API могут влиять на функциональность
- Производительность может страдать на сложных SPA приложениях

### Пользовательские риски
- Сложность настройки для нетехнических пользователей
- Необходимость поддержания актуальности шаблонов

### Возможные решения
- Система уведомлений о неработающих шаблонах
- Автоматическое обнаружение изменений в структуре страниц
- Библиотека готовых шаблонов для популярных систем
- Подробная документация и видео-руководства
